<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <title>Async Rust and TUI</title>

    <meta name="description" content="Async Rust and TUI" />
    <meta name="author" content="Cyril Marin" />
    <meta name="author" content="René Ribaud" />

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"
    />

    <link rel="stylesheet" href="../reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="../reveal.js/dist/theme/beige.css" />
    <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia"> -->
    <!-- <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Satisfy"> -->
    <!-- <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet"> -->

    <!-- Code syntax highlighting -->
    <!-- <link rel="stylesheet" href="../reveal.js/plugin/highlight/monokai.css" /> -->
    <link rel="stylesheet" href="css/stackoverflow-light.css" />

    <style type="text/css">
      .iwantitatleft {
        text-align: left;
      }

      .longtext {
        text-align: left;
        font-size: 0.6em;
      }

      /* Larger elements */
      .lots_of_items2 ul {
        font-size: 0.7em;
        text-align: left;
      }

      /* Smaller elements */
      .lots_of_items3 ul {
        font-size: 0.55em;
        text-align: left;
      }

      .lots_of_items3 ul ul {
        font-size: 0.8em;
        text-align: left;
      }

      .lots_of_items3 table {
        font-size: 0.8em;
        float: left;
        margin-right: 1em;
      }

      /* Larger elements */
      .lots_of_items4 ul {
        font-size: 0.8em;
        text-align: left;
      }

      /* Normal elements */
      .lots_of_items ul {
        font-size: 0.6em;
        text-align: left;
      }

      .lots_of_items ul ul {
        font-size: 0.8em;
        text-align: left;
      }

      .lots_of_items h3 {
        font-size: 0.7em;
      }

      .lots_of_items h4 {
        font-size: 0.6em;
      }

      .lots_of_items code {
        font-size: 0.7em;
      }

      .lots_of_items table {
        float: left;
        margin-right: 1em;
      }

      .clearfix {
        clear: left;
      }

      .long_link a {
        font-size: 0.8em;
      }

      .pic {
        position: relative;
        float: left;
        width: 50%;
        top: 0px;
      }

      /* Remove image margin use in conjuction with .pic */
      .no_margin img {
        margin: 0px;
      }

      .left_text {
        position: relative;
        float: left;
        width: 50%;
        text-align: left;
      }

      .left_text_top_margin {
        position: relative;
        float: left;
        width: 50%;
        text-align: left;
        margin-top: 66px;
      }

      .left_text_bio {
        position: relative;
        float: left;
        width: 50%;
        font-size: 0.6em;
        text-align: left;
      }

      .right_text {
        width: 50%;
        text-align: left;
        float: right;
        text-align: left;
      }

      .skill-list li {
        font-size: 1.5rem;
        margin-top: 1rem;
      }
      /*
            .reveal a { color: #007DBA; }
            .reveal h2 b { color: #0096D6; }
            .reveal h2 .day { font-size: 0.6em; position:relative; bottom: 20px; }
            .reveal { font-family: "Source Code Pro", "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans,sans-serif; font-size:40px; }
            */
      .reveal {
        font-family:
          "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
        font-size: 40px;
      }

      .reveal h2 {
        margin-top: 35px;
      }

      .reveal ul {
        margin: 0 0 0 0;
      }

      .reveal pre {
        width: 100%;
        font-size: 18px;
      }

      .reveal pre code {
        max-height: 100%;
      }

      .reveal section img {
        border: none;
        box-shadow: none;
        background: rgba(255, 255, 255, 0);
      }

      body {
        line-height: 1.1;
      }
    </style>
  </head>

  <body>
    <div class="reveal">
      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">
        <!-- <section data-background="images/background.svg" data-background-size="cover"> -->
        <section>
          <h1>Async Rust and TUI</h1>
          <img src="images/snowcamp_logo.png" alt="snowcamp_logo" width="25%" />

          <h2>Snowcamp 2026</h2>
        </section>

        <section>
          <h3>Async Rust and TUI</h3>
          <h3>Welcome and Development Environment Setup</h3>
          <div class="lots_of_items4">
            <ul>
              <li>
                Save time by doing the bevy setup if not already done or as an
                alternative use
                <a href="https://github.com/codespaces"
                  >https://github.com/codespaces</a
                >.
              </li>
              <ol>
                <li>
                  <strong>Install Rust</strong>: rustup, rustc, cargo, clippy,
                  rustfmt.
                </li>
                <li>
                  <strong>Configure Editor</strong>: Set up your preferred
                  editor with Rust Analyzer.
                </li>
                <li>
                  <strong>Clone the workshop repository</strong>
                  from GitHub.<br />
                  <a href="https://github.com/uggla/async_rust_tui"
                    >https://github.com/uggla/async_rust_tui</a
                  >
                </li>
              </ol>
              <li>Then we will do the introduction.</li>
            </ul>
          </div>
        </section>

        <section>
          <h3>2 words about us 1/2</h3>
          <div class="left_text_bio">
            <ul>
              <li>Stats</li>
              <ul>
                <li>First name: Cyril</li>
                <li>Last name: Marin</li>
              </ul>
            </ul>

            <ul>
              <li>Skills</li>
              <ul>
                <li>Class: Cloud engineer</li>
                <li>Latest Guild: Mimosa</li>
                <li>Age of Experience: 10+ years</li>
                <li>Preferred weapons: YAML, Shell</li>
              </ul>
            </ul>

            <ul>
              <li>Optional traits</li>
              <ul>
                <li>Lone wolf</li>
                <li>Ex-developer but still coder</li>
                <li>
                  The only tuxedo user among a whole team of half bitten apple
                  (Does that make me a rebel undercover?)
                </li>
              </ul>
            </ul>
          </div>
          <div class="pic">
            <img src="images/cyril.png" alt="Cyril" width="53%" />
          </div>
        </section>

        <section>
          <h3>2 words about us 2/2</h3>
          <div class="left_text_bio">
            <!-- <pre class="bio"> -->
            <ul>
              <li>Stats</li>
              <ul>
                <li>First name: René (Uggla)</li>
                <li>Last name: Ribaud</li>
              </ul>
            </ul>

            <ul>
              <li>Skills</li>
              <ul>
                <li>Class: Software engineer</li>
                <li>Previous Class: Solution architect (Cloud / Devops)</li>
                <li>Latest Guild: Red Hat</li>
                <li>Game start: 1998</li>
                <li>Preferred weapons: Rust / Python</li>
                <li>Artefact: Openstack Nova</li>
              </ul>
            </ul>

            <ul>
              <li>Optional traits</li>
              <ul>
                <li>Linux and FLOSS since 1995</li>
                <li>Previously Ops, Dev today to produce my bugs</li>
              </ul>
            </ul>
          </div>
          <div class="pic">
            <img src="images/uggla.png" alt="René" width="53%" />
          </div>
        </section>

        <section>
          <h3>Quick Overview of Rust (Optional)</h3>
          <ul>
            <li>
              Provide an alternative to C/C++ and also higher-level languages
            </li>
            <li>
              Multi paradigm language (imperative, functional, object oriented
              (not fully))
            </li>
            <li>Fast, safe, and efficient (modern)</li>
            <li>No garbage collector, ownership and borrow checker</li>
            <li>Dual license MIT and Apache v2.0</li>
            <li>First stable release May 15th, 2015</li>
          </ul>
        </section>

        <section>
          <h3>Common misconception (Optional)</h3>
          <h4>Rust has a hard learning curve</h4>
          <div class="lots_of_items2">
            <ul>
              <li>
                <strong>Yes</strong>: Rust offers many powerful features and
                concepts, which can make the language look difficult at first.
                However, you can write
                <strong>simple and idiomatic Rust</strong> without using
                everything, and learn the language
                <strong>step by step</strong>.
              </li>
              <li>
                But many frustrations come from a different root cause:
                <ul>
                  <li>
                    People <strong>don’t read the book</strong> (at least the
                    key chapters),
                  </li>
                  <li>
                    They try to
                    <strong>transpose habits from other languages</strong>, and
                    quickly hit Rust’s unique concepts (ownership/borrowing,
                    lifetimes, traits…).
                  </li>
                  <li>
                    Developers coming from <strong>C/C++</strong> sometimes feel
                    <strong>limited or constrained by the compiler</strong>.
                  </li>
                  <li>
                    People often
                    <strong>don’t read the compiler error messages</strong>,
                    even though they are usually precise and actionable.
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Some of the main difficulties (Optional)</h3>
          <div class="lots_of_items2">
            <ul>
              <li><strong>1) Immutability</strong></li>
              <ul>
                <li>
                  <strong>Immutable by default</strong> (you opt-in with
                  <code>mut</code>).
                </li>
                <li>
                  Immutable ≠ constant:
                  <ul>
                    <li><strong>const</strong> / compile-time constants</li>
                    <li>
                      <strong>immutable bindings</strong> / runtime values that
                      simply cannot be modified
                    </li>
                  </ul>
                </li>
              </ul>

              <li><strong>2) Ownership</strong> (because there is no GC)</li>
              <ul>
                <li>
                  Goal: <strong>prevent memory errors</strong> (use-after-free,
                  double free, data races).
                </li>
                <li>
                  Core tool: <strong>borrowing</strong> (use references to avoid
                  moving ownership).
                </li>
              </ul>

              <li><strong>3) Type system</strong></li>
              <ul>
                <li>
                  An extremely strict system built on
                  <strong>strong typing</strong>.
                </li>
                <li>
                  It pushes you to make states explicit (enums), model
                  invariants, and handle errors properly.
                </li>
                <li>
                  <strong>No nulls</strong>: there is no <code>null</code>.
                  Instead, Rust encodes absence and errors in the type system:
                  <ul>
                    <li><code>Option&lt;T&gt;</code> for “value or nothing”</li>
                    <li>
                      <code>Result&lt;T, E&gt;</code> for “success or error”
                    </li>
                  </ul>
                  This can feel <strong>confusing at first</strong>, but it
                  forces you to handle all cases explicitly.
                </li>
              </ul>
            </ul>
          </div>
        </section>

        <section>
          <h3>Quick Overview of the project</h3>
          <div class="left_text lots_of_items2">
            <ul>
              <li>
                Goals of the Workshop:
                <ul>
                  <li>To update with screenshot, number of part.</li>
                  <li>30mn parts, tests to validate</li>
                </ul>
              </li>
              <li>
                What we will build together.
                <ul>
                  <li>
                    A TUI dashboard for trains departures between 2 stations
                  </li>
                </ul>
              </li>
            </ul>
          </div>
          <div class="pic lots_of_items">
            <video width="100%" autoplay loop muted>
              <source src="images/asteroids.mp4" type="video/mp4" />
              Your browser does not support the video tag.
            </video>
          </div>
        </section>

        <section>
          <h3>Quick overview of the session</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                Each step starts with <strong>slides</strong>:
                <ul>
                  <li>explanation of the goal,</li>
                  <li>key concepts and points of attention.</li>
                </ul>
              </li>

              <li>
                Then we move to the code:
                <ul>
                  <li>we use <code>cargo test</code> to run the test suite,</li>
                  <li>
                    most of the time, <strong>tests will fail</strong> and you
                    will need to <strong>fix the code</strong>,
                  </li>
                  <li>
                    don’t hesitate to <strong>ask for help</strong> or request
                    additional explanations.
                  </li>
                </ul>
              </li>

              <li>
                Important note:
                <ul>
                  <li>
                    sometimes the code is correct and
                    <strong>the tests need to be fixed instead</strong>.
                  </li>
                </ul>
              </li>

              <li>
                We decide <strong>together</strong> how to proceed:
                <ul>
                  <li>we fix things live if needed,</li>
                  <li>or we move on if the audience feels comfortable.</li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <!-- ========================== -->
        <!-- BLOC 1 : INTRO & STRUCTURE -->
        <!-- ========================== -->
        <section>
          <h3>Part 1 - Setup and tracing</h3>
          <img src="images/part01.jpg" alt="setup and tracing" width="75%" />
        </section>

        <section>
          <h3>Part 1 — Setup your project correctly</h3>
          <div class="lots_of_items2">
            <ul>
              <li><strong>Workspace-based project</strong></li>
              <ul>
                <li>
                  The project is organized as a
                  <strong>Cargo workspace</strong>.
                </li>
                <li>
                  It allows us to split responsibilities into multiple crates
                  and
                  <strong>improve compilation times</strong>.
                </li>
              </ul>

              <li><strong>API crate</strong></li>
              <ul>
                <li>
                  A dedicated crate is used to interact with the external API.
                </li>
                <li>
                  Benefits:
                  <ul>
                    <li>clear separation of concerns,</li>
                    <li>reusable logic,</li>
                    <li>faster rebuilds when working on the UI.</li>
                  </ul>
                </li>
              </ul>

              <li><strong>Crate boundaries</strong></li>
              <ul>
                <li><code>lib.rs</code> — public API of a crate</li>
                <li><code>main.rs</code> — binary entry point</li>
                <li>
                  The binary imports and uses the API crate like any external
                  dependency.
                </li>
              </ul>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 1 — Setup your project correctly (cont.)</h3>
          <div class="lots_of_items2">
            <ul>
              <li><strong>Visibility & API design</strong></li>
              <ul>
                <li>Items are <strong>private by default</strong>.</li>
                <li>
                  <code>pub</code> defines what is exposed outside the crate.
                </li>
                <li>
                  Crate boundaries act as a <strong>clear API contract</strong>.
                </li>
              </ul>

              <li><strong>Error handling strategy</strong></li>
              <ul>
                <li>
                  <code>thiserror</code> — structured errors in
                  <strong>libraries</strong>
                </li>
                <li>
                  <code>anyhow</code> — ergonomic error handling in
                  <strong>binaries</strong>
                </li>
                <li>
                  Rule of thumb:
                  <ul>
                    <li><strong>Libraries</strong>: typed, explicit errors</li>
                    <li>
                      <strong>Binaries</strong>: flexible error propagation
                    </li>
                  </ul>
                </li>
              </ul>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 1 — Crates</h3>
          <div class="lots_of_items2">
            <ul>
              <li><strong>dotenvy</strong></li>
              <ul>
                <li>
                  Loads environment variables from a <code>.env</code> file.
                </li>
                <li>
                  Useful to keep configuration outside the code (API keys,
                  endpoints, feature flags).
                </li>
              </ul>

              <li><strong>tracing</strong></li>
              <ul>
                <li>
                  The <strong>go-to crate</strong> to instrument Rust
                  applications.
                </li>
                <li>
                  Designed to measure and observe execution:
                  <ul>
                    <li>structured logs,</li>
                    <li>timings and latencies,</li>
                    <li><strong>spans</strong> to follow execution paths.</li>
                  </ul>
                </li>
                <li>
                  Can export data to <strong>OpenTelemetry</strong> for advanced
                  observability.
                </li>
                <li>
                  In this workshop:
                  <ul>
                    <li>
                      we rely on
                      <strong><code>log</code> compatibility</strong>,
                    </li>
                    <li>and write logs to a <strong>file</strong>,</li>
                    <li>
                      which is essential for debugging because
                      <strong
                        >stdout / stderr are not available in TUI mode</strong
                      >.
                    </li>
                  </ul>
                </li>
              </ul>
            </ul>
          </div>
        </section>

        <!-- ======================= -->
        <!-- BLOC 2 : Async and mpsc -->
        <!-- ======================= -->
        <section>
          <h3>Part 2 - Async and mpsc</h3>
          <img src="images/part02.jpg" alt="async and mpsc" width="40%" />
        </section>

        <section>
          <h3>Part 2 — Goals</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                We move to <strong>async</strong> early on:
                <ul>
                  <li>to avoid blocking the future TUI loop,</li>
                  <li>
                    to later perform
                    <strong>real API requests asynchronously</strong>,
                  </li>
                  <li>without changing the overall architecture.</li>
                </ul>
              </li>
              <li>
                For now, the <strong>TUI loop is simulated</strong> inside the
                <code>run()</code> function.
                <ul>
                  <li>
                    It represents the future event loop: rendering, input
                    handling, and state updates.
                  </li>
                </ul>
              </li>

              <li>
                A <strong>background task</strong> simulates periodic data
                updates:
                <ul>
                  <li>it acts like the SNCF API refresh,</li>
                  <li>sends new data at regular intervals,</li>
                  <li>communicates with the TUI loop via a channel.</li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 2 — Async</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                <strong>You need an executor</strong> to run async code
                <ul>
                  <li>
                    <code>async fn</code> returns a <strong>Future</strong> (it
                    does not run by itself)
                  </li>
                  <li>
                    An executor is responsible for
                    <strong>polling</strong> futures and making progress
                  </li>
                  <li>
                    <strong>Tokio</strong> is the most common one, but it is
                    <strong>not the only executor</strong> (for example
                    <strong>Embassy</strong> for embedded systems)
                  </li>
                </ul>
              </li>

              <li>
                <strong>Tokio API looks similar to std threads</strong>
                <ul>
                  <li>
                    <code>tokio::spawn(...)</code> vs
                    <code>std::thread::spawn(...)</code>
                  </li>
                  <li>
                    <code>tokio::time::sleep(...)</code> vs
                    <code>std::thread::sleep(...)</code>
                  </li>
                  <li>
                    <strong>⚠️ Warning:</strong> make sure you import the right
                    items (<code>tokio::time</code>, <code>tokio::sync</code>,
                    etc.)
                  </li>
                </ul>
              </li>

              <li>
                <strong>Async is “colored”</strong>
                <ul>
                  <li>
                    functions must be declared <code>async fn</code> to use
                    <code>.await</code>
                  </li>
                  <li>
                    <code>.await</code> can only be used inside an
                    <code>async</code> function
                  </li>
                </ul>
              </li>

              <li>
                <strong>Futures are lazy</strong>
                <ul>
                  <li>
                    they do nothing until they are <strong>awaited</strong> (or
                    polled by the executor)
                  </li>
                  <li>
                    a spawned task is a <strong>Future</strong> that the runtime
                    will poll
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 2 — Async (cont.)</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                <strong>Task ≠ thread</strong>
                <ul>
                  <li>
                    a Tokio <strong>task</strong> is a lightweight unit of work
                    managed by the runtime
                  </li>
                  <li>
                    whether it runs on 1 OS thread or many depends on the
                    <strong>executor configuration</strong>
                    (current-thread vs multi-thread runtime)
                  </li>
                  <li>
                    tasks can be moved between worker threads by the runtime
                  </li>
                </ul>
              </li>

              <li>
                <strong>Cooperative concurrency</strong>
                <ul>
                  <li>
                    tasks must <strong>yield</strong> regularly (typically at
                    <code>.await</code> points)
                  </li>
                  <li>
                    the runtime makes progress by polling tasks that are ready
                  </li>
                </ul>
              </li>

              <li>
                <strong>⚠️ Big warning: never block the runtime</strong>
                <ul>
                  <li>
                    blocking a task can freeze <strong>all</strong> tasks on
                    that worker thread (including the TUI loop!)
                  </li>
                  <li>
                    avoid blocking calls inside async code:
                    <code>std::thread::sleep</code>, heavy CPU loops, blocking
                    I/O, etc.
                  </li>
                  <li>
                    if you must run blocking or CPU-bound work:
                    <ul>
                      <li>use <code>tokio::task::spawn_blocking</code></li>
                      <li>
                        it runs on a
                        <strong>dedicated blocking thread pool</strong>
                        and does not block the async runtime
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 2 - Tokio mpsc</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                <strong>mpsc (multi-producer, single-consumer)</strong>
                <ul>
                  <li>
                    tasks communicate by <strong>sending messages</strong>,
                  </li>
                  <li>clear data flow: producer → consumer,</li>
                  <li>no shared mutable state.</li>
                </ul>
              </li>

              <li>
                In our case:
                <ul>
                  <li>the <strong>refresh task</strong> sends updates,</li>
                  <li>
                    the <strong>TUI loop</strong> receives and processes them.
                  </li>
                </ul>
              </li>

              <li>
                <strong>Alternative: shared memory</strong>
                <ul>
                  <li>
                    <code>Arc&lt;Mutex&lt;T&gt;&gt;</code> or
                    <code>Arc&lt;RwLock&lt;T&gt;&gt;</code>
                  </li>
                  <li>
                    useful when multiple tasks need direct access to the same
                    state
                  </li>
                  <li>requires careful locking and can introduce contention</li>
                </ul>
              </li>

              <li>
                For this workshop, we prefer <strong>channels</strong>:
                <ul>
                  <li>simpler mental model,</li>
                  <li>explicit data flow,</li>
                  <li>well-suited for a TUI event loop.</li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <!-- =============================================== -->
        <!-- BLOC 3 :  Api wrapping and dependency inversion -->
        <!-- =============================================== -->
        <section>
          <h3>Part 3 - Api wrapping and dependency inversion</h3>
          <img
            src="images/part03.jpg"
            alt="Api wrapping and dependency inversion"
            width="80%"
          />
        </section>

        <section>
          <h3>Part 3 — API wrapping</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                <strong>Goal</strong>: wrap the SNCF API behind a clean and
                minimal interface.
              </li>

              <li>
                We expose only what the application really needs:
                <ul>
                  <li>
                    <code>fetch_places()</code> — retrieve and filter places
                    (stop areas),
                  </li>
                  <li>
                    <code>fetch_journeys()</code> — retrieve journeys between
                    two places.
                  </li>
                </ul>
              </li>

              <li>
                The rest of the application:
                <ul>
                  <li>does not know about HTTP,</li>
                  <li>does not know about JSON payloads,</li>
                  <li>only works with domain types.</li>
                </ul>
              </li>

              <li>
                This gives us a <strong>clear boundary</strong> between the
                external API and our core logic.
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 3 - Dependency inversion</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                Directly calling the HTTP client makes code:
                <ul>
                  <li>hard to test,</li>
                  <li>tightly coupled to the network,</li>
                  <li>dependent on external services.</li>
                </ul>
              </li>

              <li>
                Instead, we invert the dependency:
                <ul>
                  <li>define an <strong>HTTPClient trait</strong>,</li>
                  <li>
                    provide a real implementation (<code>ReqwestClient</code>),
                  </li>
                  <li>
                    provide a fake one (<code>FakeClient</code>) for tests.
                  </li>
                </ul>
              </li>

              <li>
                Benefits:
                <ul>
                  <li>test logic in <strong>isolation</strong>,</li>
                  <li>no network access during tests,</li>
                  <li>deterministic and fast test suite.</li>
                </ul>
              </li>

              <li>
                <strong>Key principle</strong>:
                <ul>
                  <li>
                    The API layer depends on <strong>abstractions</strong>, not
                    on concrete implementations.
                  </li>
                </ul>
              </li>

              <li>
                <strong>Example</strong>:
                <ul>
                  <li>
                    if the SNCF API is no longer HTTP-based (for example
                    <strong>gRPC</strong>),
                    <br />
                    <em>
                      (note: the trait name <code>HTTPClient</code> would no
                      longer be well suited in that case)
                    </em>
                  </li>
                  <li>
                    we only need a <strong>new client implementation</strong>,
                  </li>
                  <li>the rest of the application remains unchanged.</li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 3 - Time handling with jiff</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                Dealing with time is hard:
                <ul>
                  <li>time zones,</li>
                  <li>durations,</li>
                  <li>formatting for display.</li>
                </ul>
              </li>

              <li>
                We use <strong>jiff</strong> to build a solid time model:
                <ul>
                  <li>parse zoned datetimes from the API,</li>
                  <li>compute journey durations safely,</li>
                  <li>store time-related data in explicit structures.</li>
                </ul>
              </li>

              <li>
                Alternatives in the Rust ecosystem:
                <ul>
                  <li>
                    <strong>chrono</strong> — widely used, feature-rich, mature
                  </li>
                  <li>
                    <strong>time</strong> — lower-level, explicit, std-like
                    design
                  </li>
                </ul>
              </li>

              <li>
                Choice here:
                <ul>
                  <li>explicit time zones and strong types,</li>
                  <li>clear semantics for dates and durations,</li>
                  <li>a solid foundation for domain logic and UI.</li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Part 3 — What changed (and how to test)</h3>
          <div class="lots_of_items2">
            <ul>
              <li>
                Most of the changes are located in the
                <strong><code>sncf</code> crate</strong>.
                <ul>
                  <li>API wrapping,</li>
                  <li>dependency inversion,</li>
                  <li>time handling and domain mapping.</li>
                </ul>
              </li>

              <li>
                Some tests are marked as <strong>ignored</strong>:
                <ul>
                  <li>they hit the <strong>live SNCF API</strong>,</li>
                  <li>they require network access and a valid API key.</li>
                </ul>
              </li>

              <li>
                To run them:
                <ul>
                  <li>remove the <code>#[ignore]</code> attribute</li>
                </ul>
              </li>

              <li>
                <strong>Note</strong>:
                <ul>
                  <li>
                    the <code>todo!()</code> macro can be used to
                    <strong>temporarily relax the compiler</strong>
                  </li>
                  <li>
                    it allows the code to compile while a part is still missing,
                    until it is properly implemented.
                  </li>
                </ul>
              </li>
            </ul>
          </div>
        </section>
        <section>
          <h3>Introduction to Bevy Scheduler</h3>
          <div class="lots_of_items">
            <ul>
              <li><strong>Concept</strong>: Coordinates system execution.</li>
              <li>
                The systems are run in parallel so they are not sequentially
                executed.
              </li>
              <li>
                But we can control the order of execution with methods
                <code>(after, before, chain)</code>.
              </li>
              <li>
                <strong>Practical Exercise</strong>: Create and schedule systems
                in Bevy.
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>01-systems</td>
                      <td>src/main.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Manipulating Entities and Components in Bevy</h3>
          <img src="images/outrun.jpg" alt="entities_components" width="75%" />
        </section>

        <section>
          <h3>Declare entities and associate components</h3>
          <div class="lots_of_items">
            <ul>
              <li><strong>Concept</strong>: Create a Player component.</li>
              <li>Spawn an entity with the Player component.</li>
              <li>Various way of querying the component in a system.</li>
              <li>
                <strong>Practical Exercise</strong>:
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>02-components_and_entity</td>
                      <td>src/main.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Mut component(s) in entity(ies)</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                <strong>Concept</strong>: Various way of querying the Player
                component in a system and change its name value.
              </li>
              <li>
                <strong>Practical Exercise</strong>:
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>03-mut_components_and_entities</td>
                      <td>src/main.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Load default plugins and set a camera</h3>
          <img
            src="images/crystal_castle.png"
            alt="default_plugins_camera"
            width="75%"
          />
        </section>

        <section>
          <h3>Load default plugins</h3>
          <div class="lots_of_items">
            <ul>
              <li><strong>Concept</strong>: Game loop and window.</li>
              <li>Load the default plugins.</li>
              <li>DefaultPlugins is a PluginGroup, a collection of plugins.</li>
              <li>
                Define windows size constants and set a window with appropriate
                size and title.
              </li>
              <li>my_second_system "update" is now in a 60fps game loop.</li>
              <li>
                <strong>Practical Exercise</strong>:
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>04-default_plugins</td>
                      <td>src/main.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Set a 2D camera</h3>
          <div class="left_text lots_of_items">
            <ul>
              <li><strong>Concept</strong>: Camera and bundles.</li>
              <li>
                Modify first_system to spawn a Camera2dBundle or Camera2d (bevy
                0.15).
              </li>
              <li>
                A bundle is a collection of components but is now not the
                preferred way to build components but still compatible.
              </li>
              <li>
                A required macro is now used to create dependencies between
                components.
              </li>
              <li>Coordinate (0,0) at the middle of the screen.</li>
              <li>Spawn a default sprite.</li>
              <li>
                <strong>Practical Exercise</strong>:
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <td>Time</td>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>05-camera</td>
                      <td>src/main.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
          <div class="pic lots_of_items">
            <ul>
              <li>Orientation</li>
              <img src="images/coordinates.png" alt="orientation" width="65%" />
            </ul>
          </div>
        </section>

        <section>
          <h3>Resources and asset server</h3>
          <h3>Display our vessel</h3>
          <img
            src="images/captain_blood.png"
            alt="resources_and_asset_server"
            width="65%"
          />
        </section>

        <section>
          <h3>Resources</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                <strong>Definition</strong>: Shared global data accessible by
                systems.
              </li>
              <li>
                Create a resource CurrentLevel and update it's value in the
                first_system.
              </li>
              <li>Resources need to be initialized in our application.</li>
              <li>Read the CurrentLevel resource in the second_system.</li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Asset server, image, transform, display our vessel</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Asset server is a builtin resource that read assets from the
                file system.
              </li>
              <li>Add an image to the sprite using the asset server.</li>
              <li>
                The image "sprites/player.png" can be loaded from the assets
                folder by default.
              </li>
              <li>
                Remove the sprite color red and add a transformation to reduce
                the size by 2.
              </li>
              <li>
                <strong>Practical Exercise</strong>:
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>06-resources</td>
                      <td>src/main.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Manage the game states</h3>
          <img src="images/elite.png" alt="game_states" width="50%" />
        </section>

        <section>
          <h3>States</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                <strong>Definition:</strong> A state represents a specific mode
                or phase of your application, enabling systems to be selectively
                triggered based on the current state.
              </li>
              <li>
                While not essential for this mockup, states are highly
                beneficial. Implementing them from the start helps avoid a
                time-consuming rework later.
              </li>
              <li>
                States must derive the traits
                <code>Clone</code>, <code>Hash</code>, <code>Eq</code>,
                <code>PartialEq</code>, and <code>Default</code>.
              </li>
              <li>
                States need to be initialized within the application to be
                functional.
              </li>
              <li>
                Systems can be triggered or executed conditionally based on
                specific states.
              </li>
              <li>
                State information can be read using the
                <code>State</code> resource and updated with the
                <code>NextState</code> resource.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>07-states</td>
                      <td>src/main.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Create your own plugins</h3>
          <img
            src="images/defender_of_the_crown_01.png"
            alt="plugins"
            width="50%"
          />
        </section>

        <section>
          <h3>Plugins</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                <strong>Definition:</strong> A plugin is a modular unit of
                functionality that can be added to your application. Plugins
                help organize code, enable features, and set up the engine's
                systems, resources, and behaviors in a reusable and scalable
                way.
              </li>
              <li>
                Create a <code>states.rs</code> file, define a
                <code>StatePlugin</code>, and implement the
                <code>Plugin</code> trait.
              </li>
              <li>
                Refactor the code to move all state-related functionality to the
                <code>states.rs</code> file.
              </li>
              <li>
                <strong>Caution:</strong> Ensure the
                <code>GameState</code> struct is made public (<code>pub</code>).
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>08-plugins</td>
                      <td>src/main.rs<br />src/states.rs</td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>User Inputs</h3>
          <h3>Create a Simple Menu and Enable Vessel Rotation</h3>
          <img src="images/super_mario.webp" alt="user_inputs" width="50%" />
          <h5>
            At this point, we have covered almost all the fundamentals, and we
            will introduce more changes in the upcoming sections.
          </h5>
        </section>

        <section>
          <h3>Refactor States Plugin to Display a Menu</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Add a <code>Menu</code> component to tag menu-related entities.
              </li>
              <li>
                Add a system <code>display_menu</code> to create and display the
                menu when entering the <code>GameState::Menu</code> state.
              </li>
              <li>
                The menu consists of a parent entity with a
                <code>Node</code> component and a child entity with a
                <code>Text</code> component.
              </li>
              <li>
                Refactor the <code>start_game</code> system to handle user
                inputs from both keyboard and gamepad:
                <ul>
                  <li>
                    Use the
                    <code>ButtonInput&lt;KeyCode&gt;</code>
                    resource to detect keyboard inputs.
                  </li>
                  <li>
                    Use a query on the
                    <code>Gamepad</code> component to handle gamepad inputs.
                  </li>
                </ul>
              </li>
              <li>
                Add a system <code>despawn_menu</code> to remove menu entities
                when exiting the <code>GameState::Menu</code> state.
              </li>
              <li>
                <strong>Warning:</strong> The application might crash if a
                camera is not available during state transitions.
              </li>
              <li>
                Create a system in <code>main.rs</code> to spawn a
                <code>Camera2d</code> when entering the
                <code>GameState::Menu</code> state.
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Refactor Systems in main.rs to Rotate the Vessel</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Rename <code>my_first_system</code> to
                <code>setup_vessel</code>, remove all
                <code>println!</code> calls, and attach the
                <code>Player</code> component to the entity with the sprite
                component.
              </li>
              <li>
                Rename <code>my_second_system</code> to
                <code>rotate_vessel</code>, remove all
                <code>println!</code> calls, and keep only
                <code>let mut player = players.single_mut();</code>
                to perform the query.
              </li>
              <li>
                Modify the query to retrieve the entity that has both the
                <code>Player</code> and <code>Transform</code> components.
              </li>
              <li>
                Rotate the vessel around the Z-axis based on user inputs using
                <code>player.rotate_z(PI / 24.0);</code>.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>09-inputs</td>
                      <td>
                        src/main.rs<br />
                        src/states.rs
                      </td>
                      <td>15 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Debug camera</h3>
          <img
            src="images/alone_in_the_dark.png"
            alt="debug_camera"
            width="75%"
          />
        </section>

        <section>
          <h3>Refactor Camera into a Plugin and Add a Debug Camera</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Refactor the camera systems into a
                <code>CameraPlugin</code> for better modularity.
              </li>
              <li>
                Add a system <code>debug_camera</code> to handle camera
                adjustments in debug mode.
              </li>
              <li>
                The <code>debug_camera</code> system should modify the
                <code>OrthographicProjection</code> scale based on user inputs
                (<code>W</code> to zoom in and <code>X</code> to zoom out).
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>10-debug_camera</td>
                      <td>
                        src/main.rs<br />
                        src/camera.rs
                      </td>
                      <td>5 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Display Asteroids</h3>
          <img src="images/rick_dangerous.webp" alt="asteroids" width="60%" />
        </section>

        <section>
          <h3>Create an Asteroid Plugin that spawn Asteroids</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Create an <code>AsteroidPlugin</code> to improve modularity.
              </li>
              <li>
                Define an <code>Asteroid</code> structure with the fields
                <code>position</code>, <code>speed</code>, and
                <code>size</code>.
              </li>
              <li>
                Create an <code>AsteroidSize</code> structure and implement two
                methods:
                <ul>
                  <li>
                    <code>size()</code>: Returns the size of the asteroid.
                  </li>
                  <li>
                    <code>sprite()</code>: Returns the file name of the
                    asteroids sprite.
                  </li>
                </ul>
              </li>
              <li>
                Implement two systems:
                <ul>
                  <li>
                    <code>setup_asteroids</code>: Creates the field of
                    asteroids.
                  </li>
                  <li>
                    <code>despawn_asteroids</code>: Removes asteroids when
                    necessary.
                  </li>
                </ul>
              </li>
              <li>
                The <code>setup_asteroids</code> system should spawn 200
                asteroids at random sizes and positions, ensuring no overlaps.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>11-asteroids</td>
                      <td>src/camera.rs</td>
                      <td>10 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Movements</h3>
          <h3>Asteroids and Vessel Movements</h3>
          <img src="images/speedball2.png" alt="movements" width="50%" />
          <div class="longtext">
            <p>
              We could use our own physics "engine" to handle movement and
              collisions, as the required physics are relatively simple.
            </p>
            <p>
              Alternatively, we could use Rapier for physics. This would give us
              an introduction to a physics engine and save development effort.
            </p>
          </div>
        </section>

        <section>
          <h3>Moving Asteroids</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Initialize the <code>RapierPhysicsPlugin</code> and the
                <code>RapierDebugRenderPlugin</code> in the main function.
              </li>
              <li>
                Define the pixel per meter ratio used by the
                <code>RapierPhysicsPlugin</code>.
              </li>
              <li>
                Modify the <code>Asteroid</code> struct to include an additional
                field: <code>rot_speed: f32</code>.
              </li>
              <li>
                Add the following components from Rapier to the entities
                spawning asteroids to handle physics:
                <ul>
                  <li>
                    <code>RigidBody::Dynamic</code> - Declares the entity as a
                    dynamic kinematic object.
                  </li>
                  <li>
                    <code>Collider::ball</code> - Defines a collider. You can
                    use the <code>radius</code> method from the
                    <code>AsteroidSize</code> implementation.
                  </li>
                  <li>
                    <code>GravityScale</code> - Sets gravity to
                    <code>0.0</code> so that asteroids won't fall.
                  </li>
                  <li>
                    <code>Velocity</code> - Defines an initial linear and
                    angular velocity for the asteroids.
                  </li>
                </ul>
              </li>
              <li>
                Implement wrapping for the asteroids if they move farther than
                four screen widths or heights in any direction.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>12-movements</td>
                      <td>
                        src/main.rs<br />
                        src/asteroids.rs
                      </td>
                      <td>7 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Moving Vessel</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Refactor the code and add a <code>VesselPlugin</code> for better
                modularity.
              </li>
              <li>
                Define a couple of constants to set the vessel's dimensions
                (e.g., <code>VESSEL_WIDTH</code>, <code>VESSEL_HEIGHT</code>).
              </li>
              <li>
                Add the following components from Rapier to the entity spawning
                the vessel to handle physics:
                <ul>
                  <li>
                    <code>RigidBody::Dynamic</code> - Declares the entity as a
                    dynamic kinematic object.
                  </li>
                  <li>
                    <code>Collider::ball</code> - Defines a circular collider
                    using <code>VESSEL_WIDTH / 4.0</code>.
                  </li>
                  <li>
                    <code>GravityScale</code> - Sets gravity to
                    <code>0.0</code>, ensuring the vessel doesn't fall.
                  </li>
                  <li>
                    <code>ExternalImpulse</code> - Allows for velocity changes;
                    initialize with <code>ExternalImpulse::default()</code>.
                  </li>
                </ul>
              </li>
              <li>
                Add a <code>move_vessel</code> system to handle user input. This
                system should generate an impulse in the direction the vessel is
                facing. Run the code to ensure the vessel is moving properly.
              </li>
              <li>
                Add a <code>stick_camera_on_vessel</code> system to the
                <code>CameraPlugin</code> that will move (stick) the camera to
                the vessel position.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>12-movements</td>
                      <td>
                        src/main.rs<br />
                        src/vessel.rs<br />
                        src/camera.rs
                      </td>
                      <td>10 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Wrapping Vessel</h3>
          <div class="left_text lots_of_items3">
            <ul>
              <li>
                The goal is to give the player the impression of infinite space,
                even though the playable area is limited to 6 screens in size.
              </li>
              <li>
                Mechanism
                <ul>
                  <li>
                    When the player moves beyond 3 screens in any direction
                  </li>
                  <li>
                    The vessel is translated back by 6 screens in the opposite
                    direction.
                  </li>
                  <li>
                    Visible objects are translated and swapped to maintain their
                    positions relative to the vessel.
                  </li>
                </ul>
              </li>
              <li>
                <strong>Visible Objects:</strong> Defined as objects within 1
                screen of the vessel, with an additional 0.5 screen margin for
                safety.
              </li>
              <li>
                <strong>Example:</strong>
                <ul>
                  <li>If the player moves more than 3 screens to the right:</li>
                  <li>
                    The vessel is translated to -3 screens, and objects between
                    screens 2 and 4 are translated to screens -4 and -2.
                  </li>
                  <li>
                    Objects between screens -4 and -2 are translated to screens
                    2 and 6.
                  </li>
                </ul>
              </li>
              <li>
                Implement a <code>wrap_vessel</code> system to handle the above
                mechanism.
              </li>
            </ul>
          </div>
          <div class="pic no_margin">
            <img
              src="images/wrapping.svg"
              alt="wrapping_mechanism"
              width="100%"
            />
            <div class="lots_of_items3">
              <ul>
                <li>
                  <strong>Practical Exercise:</strong>
                  <div class="clearfix"></div>
                  <table>
                    <thead>
                      <tr>
                        <th>Branch</th>
                        <th>Files</th>
                        <th>Estimated Time</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>12-movements</td>
                        <td>src/vessel.rs</td>
                        <td>10 minutes</td>
                      </tr>
                    </tbody>
                  </table>
                </li>
              </ul>
            </div>
          </div>
        </section>

        <section>
          <h3>Events</h3>
          <h3>Collisions and explosions</h3>
          <img
            src="images/bomberman.png"
            alt="collisions_explosions"
            width="80%"
          />
        </section>

        <section>
          <h3>Collision Events and Timers</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                <strong>Concept</strong>: Events are critical as they allow
                communication between systems. In this example, we will use a
                pre-existing event provided by Rapier, though custom events can
                also be created.
              </li>
              <li>
                Add the following components to the Player entity:
                <ul>
                  <li>
                    <code>ActiveEvents::COLLISION_EVENTS</code> - Enables
                    collision event tracking.
                  </li>
                  <li>
                    <code>Visibility::Visible</code> - Allows control over the
                    player's visibility.
                  </li>
                  <li>
                    <code>Velocity::default()</code> - Initializes default
                    velocity (to be used later).
                  </li>
                </ul>
              </li>
              <li>
                Create a <code>vessel_collision</code> system to handle
                collision events:
                <ul>
                  <li>
                    In the initial implementation, log collision events using
                    <code>debug!()</code>.
                  </li>
                  <li>
                    Later, change the Player's visibility to hidden and spawn an
                    explosion animation.
                  </li>
                </ul>
              </li>
              <li>
                Explosion animations can be created by spawning the following
                components:
                <ul>
                  <li>
                    An <code>Explosion</code> component to identify the entity.
                  </li>
                  <li>
                    An <code>AnimationTimer</code> component that wraps a
                    <code>Timer</code> component.
                  </li>
                  <li>
                    A <code>Sprite</code> component using a
                    <code>TextureAlias</code> to display the animation.
                  </li>
                </ul>
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>13-explosions</td>
                      <td>src/vessel.rs</td>
                      <td>7 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Animations</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Create an <code>animate_player_explosion</code> system to update
                the texture atlas index of the <code>Sprite</code> component.
              </li>
              <li>
                The animation should loop by cycling through the index values
                from 0 to 8.
              </li>
              <li>
                The animation should be displayed on top of the vessel, which is
                hidden.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>13-explosions</td>
                      <td>src/vessel.rs</td>
                      <td>7 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Observers</h3>
          <h3>Manage restart, gameover and exit game</h3>
          <img
            src="images/days_of_the_tentacle.png"
            alt="observers"
            width="75%"
          />
        </section>

        <section>
          <h3>Properly Manage Restart with an Observer</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Managing the restart within the
                <code>animate_player_explosion</code> system would create
                unwanted coupling between systems.
              </li>
              <li>
                Events or observers are a better solution to ensure systems
                maintain single responsibility.
              </li>
              <li>Add a <code>Restart</code> event.</li>
              <li>
                Trigger the <code>Restart</code> event at the end of the
                explosion animation.
              </li>
              <li>
                Add an observer system (a system with a <code>Trigger</code> as
                its first parameter) to handle the restart:
                <ul>
                  <li>Set the player's visibility to visible.</li>
                  <li>Reset the player's velocity to default.</li>
                  <li>
                    Translate the vessel back to the origin and rotate it to
                    angle 0.
                  </li>
                  <li>
                    Decrease the player's number of lives. If no lives remain,
                    transition the <code>AppState</code> to
                    <code>Gameover</code>.
                  </li>
                </ul>
              </li>
              <li>Add the observer system to the app.</li>
              <li>
                Add a <code>despawn_vessel</code> system to despawn the vessel
                when <code>Ingame</code> state is exited.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>14-observers</td>
                      <td>src/vessel.rs</td>
                      <td>7 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Manage Gameover and Exit Game</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Create a <code>display_gameover</code> system by duplicating the
                <code>display_menu</code> system.
              </li>
              <li>
                Add the <code>display_gameover</code> system to run when the
                <code>Gameover</code> state is entered.
              </li>
              <li>
                Rename the <code>start_game</code> system to
                <code>manage_inputs</code>, and update it to handle input
                controls in the <code>Gameover</code> state.
              </li>
              <li>
                Trigger the <code>AppExit::Success</code> event if the player
                presses the Escape key to exit the game.
              </li>
              <li>
                Update the app to execute the <code>manage_inputs</code> system
                in the <code>Gameover</code> state.
              </li>
              <li>
                Note: A potential issue could arise with the camera
                transitioning back to the <code>Menu</code> state. Handle this
                case carefully.
              </li>
              <li>
                <strong>Bonus:</strong> Add an <code>exit_to_menu</code> system
                in <code>vessel.rs</code> to allow returning to the
                <code>Menu</code>.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>14-observers</td>
                      <td>
                        src/state.rs<br />
                        src/vessel.rs<br />
                        src/camera.rs
                      </td>
                      <td>7 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Vessel lasers</h3>
          <img
            src="images/super_mario_world.webp"
            alt="vessel_lasers"
            width="75%"
          />
        </section>

        <section>
          <h3>Lasers</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Create a <code>fire_lasers</code> system to spawn lasers at the
                vessel's wings when the player fires.
                <ul>
                  <li>Take care of the sprite orientation.</li>
                  <li>
                    Set an initial velocity for the lasers. You can use constant
                    values for laser properties provided in the branch.
                  </li>
                </ul>
              </li>
              <li>
                Add a <code>restrict_lasers_range</code> system to limit the
                laser range. This can be achieved by despawning the lasers after
                they exceed a certain lifetime.
                <ul>
                  <li>
                    A possible solution is to add a <code>Laser</code> component
                    to the laser entity, which includes a timer.
                  </li>
                </ul>
              </li>
              <li>
                Update the <code>vessel_collision</code> system to handle laser
                collisions:
                <ul>
                  <li>Despawn the laser and the asteroid it collides with.</li>
                  <li>Spawn an explosion animation at the collision point.</li>
                  <li>
                    The code shows the following techniques:
                    <ul>
                      <li>
                        Retrieve components from a known entity using the
                        <code>get()</code> method.
                      </li>
                      <li>Track the ID of a spawned entity.</li>
                      <li>Add components to a newly spawned entity.</li>
                    </ul>
                  </li>
                  <li>
                    Feel free to refer to the proposed code, but try
                    implementing your own solution for better learning.
                  </li>
                  <li>
                    Note: The proposed code modifies <code>vessel.rs</code> for
                    convenience, but for better maintainability, you should
                    consider splitting the logic into separate modules or
                    plugins.
                  </li>
                </ul>
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>15-lasers</td>
                      <td>src/vessel.rs</td>
                      <td>15 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Explosions</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Asteroid explosions require special handling (e.g., size,
                splitting asteroids) compared to vessel explosions. Create a new
                <code>animate_asteroid_explosion</code> system for this purpose.
              </li>
              <li>
                Initially, play the explosion animation and despawn it once
                completed.
              </li>
              <li>
                <strong>Bonus 1:</strong> Scale the explosion size based on the
                asteroid size.
              </li>
              <li>
                <strong>Bonus 2:</strong> Split large asteroids into two medium
                ones, and medium asteroids into two tiny ones upon explosion
                completion.
              </li>
              <li>
                <strong>Bonus 3:</strong> Assign random velocities, but ensure
                they move orthogonal to the laser's trajectory.
              </li>
              <li>
                <strong>Potential Challenges:</strong>
                <ul>
                  <li>
                    Private asteroid methods and properties need to be made
                    public for reuse.
                  </li>
                  <li>
                    Non-unique events can lead to spawning extra asteroids
                    (e.g., 4 instead of 2). Ensure only one event is processed.
                  </li>
                  <li>
                    Warning messages about already despawned entities may occur.
                    Add constraints to ensure the collision system runs first.
                  </li>
                  <li>
                    Note: System execution order often causes strange behaviors.
                    Pay attention to dependencies and ordering.
                  </li>
                </ul>
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>15-lasers</td>
                      <td>
                        src/vessel.rs<br />
                        src/asteroid.rs
                      </td>
                      <td>15 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Audio</h3>
          <h3>Thrust, Lasers, Explosions Sounds</h3>
          <img src="images/prince_of_persia.png" alt="audio" width="75%" />
        </section>

        <section>
          <h3>Thrust, Lasers, Explosions Sounds</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Spawn an entity with <code>AudioPlayer</code> and
                <code>PlaybackSettings</code> when a laser is fired.
                <ul>
                  <li>
                    <code>PlaybackSettings</code> controls volume and playback
                    mode. Using <code>PlaybackMode::Despawn</code>, the entity
                    will automatically despawn when the sound finishes.
                  </li>
                </ul>
              </li>
              <li>Repeat this process for explosion sounds.</li>
              <li>
                Apply the same approach for thrust sounds when the vessel is
                thrusting.
                <ul>
                  <li>
                    <strong>Potential Challenge:</strong>
                    <ul>
                      <li>
                        The sound might not finish playing before a new one is
                        triggered, leading to overlapping and odd audio effects.
                      </li>
                      <li>
                        A possible solution is to avoid spawning a new sound if
                        the current one is still playing.
                      </li>
                    </ul>
                  </li>
                </ul>
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>16-audio</td>
                      <td>src/vessel.rs</td>
                      <td>7 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Radar</h3>
          <img src="images/another_world.webp" alt="radar" width="75%" />
        </section>

        <section>
          <h3>Radar</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Spawn a radar entity in the <code>setup_vessel</code> system to
                display the radar sprite.
              </li>
              <li>
                Create a <code>radar</code> system to update the radar's
                orientation, ensuring it points to the nearest asteroid.
              </li>
              <li>
                <strong>Bonus:</strong> Adapt the radar color based on the
                distance to the nearest asteroid.
                <ul>
                  <li>
                    Consider using HSV values for defining the color, as this
                    allows adjusting only the saturation to create a color
                    variation.
                  </li>
                </ul>
              </li>
              <li>
                Ensure the radar entity is despawned appropriately when no
                longer needed.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>17-radar</td>
                      <td>src/vessel.rs</td>
                      <td>10 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>UI</h3>
          <img src="images/barbarian.png" alt="ui" width="75%" />
        </section>

        <section>
          <h3>UI</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Create a <code>ui</code> system to display the player's
                remaining lives, the number of asteroids, and the time elapsed
                since the game started.
              </li>
              <li>
                Create an <code>update_ui</code> system to retrieve and display
                this data dynamically in the UI.
              </li>
              <li>
                Implement a <code>despawn_ui</code> system to remove the UI when
                it is no longer needed.
              </li>
              <li>
                Integrate these systems into the plugin and ensure they are
                triggered at the appropriate times during gameplay.
              </li>
              <li>Warning: The code to decrease lives have a bug.</li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>18-ui</td>
                      <td>src/state.rs</td>
                      <td>10 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Game Finished</h3>
          <h3>You Win!</h3>
          <img src="images/xenon2.jpg" alt="you_win" width="60%" />
        </section>

        <section>
          <h3>You Win! Menu</h3>
          <div class="lots_of_items">
            <ul>
              <li>Add a new game state: <code>Gamestate::Win</code>.</li>
              <li>
                Implement a <code>check_win</code> system to monitor if all
                asteroids have been cleared. If so, transition to the
                <code>Win</code> state.
              </li>
              <li>
                Create a <code>display_win</code> system to show the victory
                screen. This system can be adapted from the
                <code>display_menu</code> system.
              </li>
              <li>
                Handle player input to exit the victory menu and return to the
                main menu.
              </li>
              <li>
                Integrate the new systems into the plugin and ensure they are
                executed at the appropriate times during gameplay.
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>19-win</td>
                      <td>src/state.rs</td>
                      <td>7 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>A background with stars</h3>
          <img src="images/sonic.jpg" alt="background" width="75%" />
        </section>

        <section>
          <h3>Background</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Add a new <code>Background</code> component to identify
                background entities.
              </li>
              <li>
                Modify the <code>AsteroidsPlugin</code>:
                <ul>
                  <li>
                    Add a <code>background</code> system to spawn the starry
                    background when entering <code>GameState::InGame</code>.
                  </li>
                  <li>
                    Add a <code>despawn_background</code> system to remove
                    background entities when exiting
                    <code>GameState::InGame</code>.
                  </li>
                </ul>
              </li>
              <li>
                Implement the <code>background</code> system:
                <ul>
                  <li>
                    Create a starry image using an <code>ImageBuffer</code> with
                    randomly placed white dots (stars).
                  </li>
                  <li>
                    Convert the <code>ImageBuffer</code> into a Bevy
                    <code>Image</code> asset.
                  </li>
                  <li>
                    Spawn multiple sprites using the generated image to cover
                    the game area.
                  </li>
                </ul>
              </li>
              <li>
                <strong>Practical Exercise:</strong> Implement and test the
                background rendering and cleanup.
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>20-background</td>
                      <td>src/asteroids.rs</td>
                      <td>10 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Build WASM</h3>
          <img src="images/bubble_bobble.png" alt="wasm" width="75%" />
        </section>

        <section>
          <h3>Prevent Blurry Sprites and WASM Compatibility</h3>
          <div class="lots_of_items">
            <ul>
              <li>
                Added <code>ImagePlugin::default_nearest()</code>:
                <ul>
                  <li>
                    Ensures sprites are rendered with nearest-neighbor scaling
                    to prevent blurriness when scaling.
                  </li>
                  <li>
                    This is especially useful for pixel art or retro-style
                    graphics.
                  </li>
                </ul>
              </li>
              <li>
                Updated the <code>AssetPlugin</code> configuration:
                <ul>
                  <li>
                    Added <code>meta_check: AssetMetaCheck::Never</code> to
                    avoid checking for meta files during WASM builds.
                  </li>
                  <li>
                    This prevents errors and potential panics on platforms like
                    itch.io.
                  </li>
                </ul>
              </li>
              <li>
                Build a wasm version of the game. This can be achieve by running
                the <code>./build_wasm.sh</code>. The script will:
                <ul>
                  <li>
                    Simply build the application using the
                    <code>wasm32-unknown-unknown</code> target.
                  </li>
                  <li>
                    Run <code>wasm-bindgen</code> cli to build the function
                    bindings for javascript into a single file (bevy_game.js).
                  </li>
                  <li>
                    Then the html file (index.html) just need to call the init
                    function from the file produced by
                    <code>wasm-bindgen</code>.
                  </li>
                </ul>
              </li>
              <li>
                <strong>Practical Exercise:</strong>
                <div class="clearfix"></div>
                <table>
                  <thead>
                    <tr>
                      <th>Branch</th>
                      <th>Files</th>
                      <th>Estimated Time</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>21-wasm</td>
                      <td>src/main.rs</td>
                      <td>10 minutes</td>
                    </tr>
                  </tbody>
                </table>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h3>Build with BEVY</h3>
          <img src="images/simcity.jpg" alt="wasm" width="75%" />
        </section>

        <section>
          <h3>Rock Run Rose's Odyssey</h3>
          <h4>Made with ❤️ by Uggla</h4>
          <img src="images/rockrun.png" alt="rockrun" width="90%" />
          <h5>https://uggla.itch.io/rockrun</h5>
        </section>

        <section>
          <h3>neoroll</h3>
          <h4>Made with ❤️ by bux</h4>
          <img src="images/neoroll.png" alt="neoroll" width="85%" />
          <h5>https://github.com/buxx/neoroll</h5>
        </section>

        <section>
          <h3>Open Combat (need rewrite in bevy)</h3>
          <h4>Made with ❤️ by bux</h4>
          <img src="images/opencombat.png" alt="neoroll" width="85%" />
          <h5>https://github.com/buxx/OpenCombat</h5>
        </section>

        <section>
          <h3>Tiny Glade</h3>
          <img src="images/tiny_glade.jpg" alt="tiny_glade" width="100%" />
          <h5>https://store.steampowered.com/app/2198150/Tiny_Glade</h5>
        </section>

        <section>
          <h3>DEATHTRIP</h3>
          <img src="images/deathtrip.jpg" alt="deathtrip" width="100%" />
          <h5>https://store.steampowered.com/app/2909010/DEATHTRIP/</h5>
        </section>

        <section>
          <h3>Jarl</h3>
          <img src="images/jarl.png" alt="jarl" width="100%" />
          <h5>https://www.jarl-game.com/</h5>
        </section>

        <section>
          <h3>Astortion</h3>
          <img src="images/astortion.jpg" alt="astortion" width="100%" />
          <h5>https://store.steampowered.com/app/1993980/Astortion/</h5>
        </section>

        <section>
          <h3>Times of progress</h3>
          <img
            src="images/times_of_progress.jpg"
            alt="times_of_progress"
            width="100%"
          />
          <h5>https://store.steampowered.com/app/2628450/Times_of_Progress/</h5>
        </section>

        <section>
          <h3>Gunbug</h3>
          <img src="images/gunbug.jpg" alt="gunbug" width="100%" />
          <h5>https://store.steampowered.com/app/2946990/Gunbug/</h5>
        </section>

        <section>
          <h2>Thanks</h2>
          <div class="left_text_top_margin">
            <img src="images/thanks.gif" alt="thank_you" width="100%" />
          </div>
          <div class="right_text">
            <img src="images/qr_feedback.png" alt="feedback" width="100%" />
          </div>
          <!-- <ul> -->
          <!--   <li>Bastien Sevajol &lt;bastien@sevajol.fr&gt;</li> -->
          <!--   <li>René Ribaud &lt;rene.ribaud@gmail.com&gt;</li> -->
          <!-- </ul> -->
        </section>
      </div>
    </div>

    <script type="module">
      import Reveal from "../reveal.js/dist/reveal.esm.js";
      import Markdown from "../reveal.js/plugin/markdown/markdown.esm.js";
      import Notes from "../reveal.js/plugin/notes/notes.esm.js";
      import Highlight from "../reveal.js/plugin/highlight/highlight.esm.js";
      import Zoom from "../reveal.js/plugin/zoom/zoom.esm.js";

      let deck = new Reveal({
        plugins: [Markdown, Notes, Highlight, Zoom],
        controls: true,
        progress: true,
        history: true,
        center: false,
        width: 960,
        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,
        // Use this to print in pdf
        // margin: 0.6,

        // Bounds for smallest/largest possible scale to apply to content
        minScale: 0.2,
        maxScale: 1.5,

        transition: "convex",
      });

      deck.initialize();
    </script>
  </body>
</html>
